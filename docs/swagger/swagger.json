{
    "swagger": "2.0",
    "info": {
        "contact": {}
    },
    "paths": {
        "/jobs": {
            "get": {
                "description": "Returns in-memory jobs tracked by the orchestrator.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "List active jobs",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/app.Job"
                            }
                        }
                    }
                }
            }
        },
        "/jobs/{jobID}": {
            "get": {
                "description": "Returns the current state of a background job.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Get job details",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job identifier",
                        "name": "jobID",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/app.Job"
                        }
                    },
                    "404": {
                        "description": "Not Found",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "description": "Signals the orchestrator to stop a running job.",
                "tags": [
                    "Jobs"
                ],
                "summary": "Cancel a job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Job identifier",
                        "name": "jobID",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "204": {
                        "description": "No Content",
                        "schema": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "/projects": {
            "get": {
                "description": "Returns all configured projects.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Projects"
                ],
                "summary": "List projects",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/registry.Project"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "description": "Creates a named project that groups websites.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Projects"
                ],
                "summary": "Create a project",
                "parameters": [
                    {
                        "description": "Project payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.CreateProjectRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/registry.Project"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/projects/{project}/websites": {
            "get": {
                "description": "Retrieves websites scoped to a project slug.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Websites"
                ],
                "summary": "List websites in a project",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/registry.Website"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "description": "Registers a website origin scoped to the provided project slug.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Websites"
                ],
                "summary": "Create a website inside a project",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Website payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.CreateWebsiteRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/registry.Website"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/projects/{project}/websites/{site}/endpoints": {
            "get": {
                "description": "Lists endpoints for the given project/site combination.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Endpoints"
                ],
                "summary": "List website endpoints",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "default": "new",
                        "description": "Filter by status",
                        "name": "status",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Maximum results",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/indexer.Endpoint"
                            }
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "description": "Adds canonicalized URLs to the endpoint index for a website.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Endpoints"
                ],
                "summary": "Add website endpoints",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Endpoint payload",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/server.AddWebsiteEndpointsRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/server.AddedEndpointsResponse"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/projects/{project}/websites/{site}/endpoints/details": {
            "get": {
                "description": "Returns snapshot, scoring, diff, and security info for a canonical URL.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Endpoints"
                ],
                "summary": "Get detailed endpoint information",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Canonical URL",
                        "name": "url",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/app.EndpointDetails"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/projects/{project}/websites/{site}/jobs/enumerate": {
            "post": {
                "description": "Launches a crawl that discovers new endpoints up to a default depth of 4.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Start an enumeration job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Accepted",
                        "schema": {
                            "$ref": "#/definitions/app.Job"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/projects/{project}/websites/{site}/jobs/fetch": {
            "post": {
                "description": "Triggers a fetch of endpoints, optionally filtered by status/limit.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Jobs"
                ],
                "summary": "Start a fetch job",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    },
                    {
                        "description": "Fetch options",
                        "name": "request",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/server.StartFetchJobRequest"
                        }
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Accepted",
                        "schema": {
                            "$ref": "#/definitions/app.Job"
                        }
                    },
                    "500": {
                        "description": "Internal Server Error",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/ws/projects/{project}/websites/{site}/enumerate": {
            "get": {
                "description": "Upgrades the connection and streams enumeration progress events.",
                "tags": [
                    "Jobs"
                ],
                "summary": "Stream enumerate job events over WebSocket",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "101": {
                        "description": "WebSocket Upgrade",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/ws/projects/{project}/websites/{site}/fetch": {
            "get": {
                "description": "Upgrades the connection and streams fetch progress events.",
                "tags": [
                    "Jobs"
                ],
                "summary": "Stream fetch job events over WebSocket",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Project slug",
                        "name": "project",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Website slug",
                        "name": "site",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "default": "new",
                        "description": "Endpoint status filter",
                        "name": "status",
                        "in": "query"
                    },
                    {
                        "type": "integer",
                        "description": "Maximum endpoints",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "101": {
                        "description": "WebSocket Upgrade",
                        "schema": {
                            "type": "string"
                        }
                    },
                    "400": {
                        "description": "Bad Request",
                        "schema": {
                            "$ref": "#/definitions/server.ErrorResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "app.EndpointDetails": {
            "type": "object",
            "properties": {
                "diff": {
                    "$ref": "#/definitions/models.CombinedFileDiff"
                },
                "score_result": {
                    "$ref": "#/definitions/assessor.ScoreResult"
                },
                "security_diff": {
                    "$ref": "#/definitions/assessor.SecurityDiff"
                },
                "snapshot": {
                    "$ref": "#/definitions/models.Snapshot"
                }
            }
        },
        "app.Job": {
            "type": "object",
            "properties": {
                "ended_at": {
                    "type": "string"
                },
                "enumerated_urls": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "error": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "project": {
                    "type": "string"
                },
                "security_overview": {
                    "$ref": "#/definitions/assessor.SecurityDiffOverview"
                },
                "started_at": {
                    "type": "string"
                },
                "status": {
                    "$ref": "#/definitions/app.JobStatus"
                },
                "type": {
                    "type": "string"
                },
                "website": {
                    "type": "string"
                }
            }
        },
        "app.JobStatus": {
            "type": "string",
            "enum": [
                "pending",
                "running",
                "done",
                "failed",
                "canceled"
            ],
            "x-enum-varnames": [
                "JobPending",
                "JobRunning",
                "JobDone",
                "JobFailed",
                "JobCanceled"
            ]
        },
        "assessor.EvidenceItem": {
            "type": "object",
            "properties": {
                "contribution": {
                    "description": "Contribution is the numeric score contribution of this specific evidence item.\nUsed to explain how each piece of evidence contributed to the overall score.",
                    "type": "number"
                },
                "description": {
                    "description": "Description is a short human-readable explanation of the evidence.",
                    "type": "string"
                },
                "id": {
                    "description": "ID is an optional stable identifier for this evidence item in the ScoreResult.\nUseful for attribution rows to reference an evidence item unambiguously.",
                    "type": "string"
                },
                "key": {
                    "description": "Key is a short identifier for the evidence (e.g. \"has-iframe\", \"suspicious-link\").",
                    "type": "string"
                },
                "locations": {
                    "description": "Locations holds zero or more structured locators where this evidence was observed.\nWhen non-empty it enables exact attribution and deterministic UI highlighting.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/assessor.EvidenceLocation"
                    }
                },
                "rule_id": {
                    "description": "RuleID identifies the rule that produced this evidence.",
                    "type": "string"
                },
                "severity": {
                    "description": "Severity is a human-level severity bucket such as \"low\", \"medium\", \"high\", \"critical\".",
                    "type": "string"
                },
                "value": {
                    "description": "Value contains the raw value that triggered the evidence (string/number/map...)."
                }
            }
        },
        "assessor.EvidenceLocation": {
            "type": "object",
            "properties": {
                "byte_end": {
                    "type": "integer"
                },
                "byte_start": {
                    "description": "Optional byte offsets into the file/body (start inclusive, end exclusive).\nUseful when the assessor is text-based rather than DOM-aware.",
                    "type": "integer"
                },
                "column": {
                    "type": "integer"
                },
                "cookie_name": {
                    "description": "For cookie-based evidence: the name of the cookie.",
                    "type": "string"
                },
                "dom_index": {
                    "type": "integer"
                },
                "file_path": {
                    "description": "Optional file path relative to the site working tree.",
                    "type": "string"
                },
                "header_name": {
                    "description": "For header-based evidence: the name of the header.",
                    "type": "string"
                },
                "line": {
                    "description": "Line and Column for precise text-based locations.",
                    "type": "integer"
                },
                "line_end": {
                    "type": "integer"
                },
                "line_start": {
                    "description": "Optional line numbers (1-based). Useful for working-tree highlighting in the UI.",
                    "type": "integer"
                },
                "note": {
                    "description": "Optional human note about this specific location (e.g., \"in modal dialog\").",
                    "type": "string"
                },
                "param_name": {
                    "type": "string"
                },
                "parent_dom_index": {
                    "description": "Dom Index is the 0-based index of the element in document.getElementsByTagName(\"*\").",
                    "type": "integer"
                },
                "regex": {
                    "description": "Regex pattern that matched (if applicable).",
                    "type": "string"
                },
                "selector": {
                    "description": "Preferred: CSS selector that identifies the element.",
                    "type": "string"
                },
                "snapshot_id": {
                    "type": "string"
                },
                "type": {
                    "description": "Type describes what kind of location this is (e.g., \"css\", \"xpath\", \"header\", \"cookie\").\nUsed by the UI to determine how to interpret and highlight the location.",
                    "type": "string"
                },
                "xpath": {
                    "description": "XPath expression (optional alternative to CSS selector).",
                    "type": "string"
                }
            }
        },
        "assessor.Rule": {
            "type": "object",
            "properties": {
                "id": {
                    "description": "unique rule id (eg. \"forms:autocomplete-off\")",
                    "type": "string"
                },
                "key": {
                    "description": "short key presented in UI (eg. \"autocomplete-off\")",
                    "type": "string"
                },
                "regex": {
                    "description": "optional regex pattern (compiled at constructor)",
                    "type": "string"
                },
                "selector": {
                    "description": "optional CSS selector to match nodes",
                    "type": "string"
                },
                "severity": {
                    "description": "\"low\"|\"medium\"|\"high\"|\"critical\"",
                    "type": "string"
                },
                "weight": {
                    "description": "numeric weight used to build score",
                    "type": "number",
                    "format": "float64"
                }
            }
        },
        "assessor.ScoreResult": {
            "type": "object",
            "properties": {
                "attack_surface": {
                    "$ref": "#/definitions/attacksurface.AttackSurface"
                },
                "confidence": {
                    "description": "Confidence is the assessor's confidence [0.0 .. 1.0] in this result.",
                    "type": "number"
                },
                "contrib_by_rule": {
                    "description": "ContribByRule maps rule IDs to their total contribution to the score.\nThis allows computing rule deltas between versions without re-running the assessor.",
                    "type": "object",
                    "additionalProperties": {
                        "type": "number",
                        "format": "float64"
                    }
                },
                "evidence": {
                    "description": "Evidence is the list of contributing evidence items.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/assessor.EvidenceItem"
                    }
                },
                "matched_rules": {
                    "description": "MatchedRules lists rules that matched during evaluation.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/assessor.Rule"
                    }
                },
                "meta": {
                    "description": "Meta contains any additional metadata about the scoring process.",
                    "type": "object",
                    "additionalProperties": {}
                },
                "normalized": {
                    "description": "Normalized is an integer normalized form [0 .. 100] for ease of reporting.",
                    "type": "integer"
                },
                "raw_features": {
                    "description": "RawFeatures contains extracted numeric features (featureName -\u003e value), e.g: \"has_password_field\": 1.0, num_forms: 3.0",
                    "type": "object",
                    "additionalProperties": {
                        "type": "number",
                        "format": "float64"
                    }
                },
                "score": {
                    "description": "Score is the normalized internal score range [0.0 .. 1.0].",
                    "type": "number"
                },
                "snapshot_id": {
                    "description": "SnapshotID is the snapshot this score applies to.",
                    "type": "string"
                },
                "timestamp": {
                    "description": "Timestamp is the time when this ScoreResult was produced.",
                    "type": "string"
                },
                "version": {
                    "description": "Version identifies the scoring algorithm / heuristics version used.\nThis should map to the assessor's ruleset version (for auditability).",
                    "type": "string"
                },
                "version_id": {
                    "description": "VersionID is the version this score applies to.",
                    "type": "string"
                }
            }
        },
        "assessor.SecurityDiff": {
            "type": "object",
            "properties": {
                "attack_surface_changed": {
                    "description": "Attack surface deltas",
                    "type": "boolean"
                },
                "attack_surface_changes": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.AttackSurfaceChange"
                    }
                },
                "base_snapshot_id": {
                    "type": "string"
                },
                "base_version_id": {
                    "type": "string"
                },
                "feature_deltas": {
                    "description": "Optional extra detail",
                    "type": "object",
                    "additionalProperties": {
                        "type": "number",
                        "format": "float64"
                    }
                },
                "head_snapshot_id": {
                    "type": "string"
                },
                "head_version_id": {
                    "type": "string"
                },
                "rule_deltas": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "number",
                        "format": "float64"
                    }
                },
                "score_base": {
                    "description": "Score deltas",
                    "type": "number"
                },
                "score_delta": {
                    "type": "number"
                },
                "score_head": {
                    "type": "number"
                },
                "url": {
                    "type": "string"
                }
            }
        },
        "assessor.SecurityDiffOverview": {
            "type": "object",
            "properties": {
                "base_version_id": {
                    "type": "string"
                },
                "entries": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/assessor.SecurityDiffOverviewEntry"
                    }
                },
                "head_version_id": {
                    "type": "string"
                }
            }
        },
        "assessor.SecurityDiffOverviewEntry": {
            "type": "object",
            "properties": {
                "attack_surface_changed": {
                    "type": "boolean"
                },
                "base_snapshot_id": {
                    "type": "string"
                },
                "head_snapshot_id": {
                    "type": "string"
                },
                "num_attack_surface_changes": {
                    "type": "integer"
                },
                "regressed": {
                    "description": "(scoreDelta \u003e 0) for quick UI signals",
                    "type": "boolean"
                },
                "score_base": {
                    "type": "number"
                },
                "score_delta": {
                    "type": "number"
                },
                "score_head": {
                    "type": "number"
                },
                "url": {
                    "type": "string"
                }
            }
        },
        "attacksurface.AttackSurface": {
            "type": "object",
            "properties": {
                "collected_at": {
                    "type": "string"
                },
                "content_type": {
                    "type": "string"
                },
                "cookies": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.CookieInfo"
                    }
                },
                "error_indicators": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "event_handlers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.EventHandlerInfo"
                    }
                },
                "forms": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.Form"
                    }
                },
                "framework_hints": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "get_params": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.Param"
                    }
                },
                "headers": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                "post_params": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.Param"
                    }
                },
                "scripts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.ScriptInfo"
                    }
                },
                "snapshot_id": {
                    "type": "string"
                },
                "status_code": {
                    "type": "integer"
                },
                "url": {
                    "type": "string"
                }
            }
        },
        "attacksurface.AttackSurfaceChange": {
            "type": "object",
            "properties": {
                "detail": {
                    "description": "human-readable description of the change",
                    "type": "string"
                },
                "evidence_locations": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.EvidenceLocation"
                    }
                },
                "kind": {
                    "description": "e.g., \"form_added\", \"input_added\", \"header_changed\", \"cookie_changed\", \"script_added\"",
                    "type": "string"
                }
            }
        },
        "attacksurface.CookieInfo": {
            "type": "object",
            "properties": {
                "domain": {
                    "type": "string"
                },
                "http_only": {
                    "type": "boolean"
                },
                "name": {
                    "type": "string"
                },
                "path": {
                    "type": "string"
                },
                "same_site": {
                    "type": "string"
                },
                "secure": {
                    "type": "boolean"
                }
            }
        },
        "attacksurface.EventHandlerInfo": {
            "type": "object",
            "properties": {
                "element_selector": {
                    "type": "string"
                },
                "event_type": {
                    "description": "e.g. \"click\", \"submit\"",
                    "type": "string"
                }
            }
        },
        "attacksurface.EvidenceLocation": {
            "type": "object",
            "properties": {
                "cookie_name": {
                    "type": "string"
                },
                "dom_index": {
                    "description": "index into getElementsByTagName for this Type",
                    "type": "integer"
                },
                "header_name": {
                    "type": "string"
                },
                "param_name": {
                    "type": "string"
                },
                "parent_dom_index": {
                    "description": "index of parent form for inputs",
                    "type": "integer"
                },
                "snapshot_id": {
                    "type": "string"
                },
                "type": {
                    "description": "\"form\",\"input\",\"header\",\"cookie\",\"script\",...",
                    "type": "string"
                }
            }
        },
        "attacksurface.Form": {
            "type": "object",
            "properties": {
                "action": {
                    "type": "string"
                },
                "dom_classes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "dom_id": {
                    "type": "string"
                },
                "dom_index": {
                    "description": "Location hints\n0-based index into formElement.getElementsByTagName(\"form\")",
                    "type": "integer"
                },
                "inputs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/attacksurface.FormInput"
                    }
                },
                "method": {
                    "type": "string"
                }
            }
        },
        "attacksurface.FormInput": {
            "type": "object",
            "properties": {
                "dom_classes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "dom_id": {
                    "type": "string"
                },
                "dom_index": {
                    "description": "Location hints\n0-based index into formElement.getElementsByTagName(\"input\")",
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                },
                "required": {
                    "type": "boolean"
                },
                "type": {
                    "type": "string"
                }
            }
        },
        "attacksurface.Param": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string"
                },
                "origin": {
                    "description": "\"query\", \"body\", \"form\"",
                    "type": "string"
                }
            }
        },
        "attacksurface.ScriptInfo": {
            "type": "object",
            "properties": {
                "dom_index": {
                    "description": "Location hints\n0-based index into document.getElementsByTagName(\"script\")",
                    "type": "integer"
                },
                "inline": {
                    "type": "boolean"
                },
                "src": {
                    "type": "string"
                }
            }
        },
        "indexer.Endpoint": {
            "type": "object",
            "properties": {
                "canonical_url": {
                    "type": "string"
                },
                "first_discovered_at": {
                    "type": "integer"
                },
                "host": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "last_discovered_at": {
                    "type": "integer"
                },
                "last_fetched_at": {
                    "type": "integer"
                },
                "last_fetched_version": {
                    "type": "string"
                },
                "meta": {
                    "type": "string"
                },
                "path": {
                    "type": "string"
                },
                "source": {
                    "type": "string"
                },
                "status": {
                    "type": "string"
                },
                "url": {
                    "type": "string"
                }
            }
        },
        "models.BodyDiff": {
            "type": "object",
            "properties": {
                "base_id": {
                    "type": "string"
                },
                "chunks": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.DiffChunk"
                    }
                },
                "head_id": {
                    "type": "string"
                }
            }
        },
        "models.Change": {
            "type": "object",
            "properties": {
                "from": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "to": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "models.CombinedFileDiff": {
            "type": "object",
            "properties": {
                "body_diff": {
                    "$ref": "#/definitions/models.BodyDiff"
                },
                "file_path": {
                    "type": "string"
                },
                "headers_diff": {
                    "$ref": "#/definitions/models.HeaderDiff"
                }
            }
        },
        "models.DiffChunk": {
            "type": "object",
            "properties": {
                "base_len": {
                    "type": "integer"
                },
                "base_start": {
                    "type": "integer"
                },
                "content": {
                    "description": "content for added/modified chunks",
                    "type": "string"
                },
                "head_len": {
                    "type": "integer"
                },
                "head_start": {
                    "type": "integer"
                },
                "path": {
                    "description": "optional DOM selector or descriptor",
                    "type": "string"
                },
                "type": {
                    "description": "e.g., \"added\", \"removed\", \"modified\"",
                    "type": "string"
                }
            }
        },
        "models.HeaderDiff": {
            "type": "object",
            "properties": {
                "added": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                "changed": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/models.Change"
                    }
                },
                "redacted": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "removed": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "models.Snapshot": {
            "type": "object",
            "properties": {
                "body": {
                    "description": "Body contains the raw HTML bytes for the snapshot.",
                    "type": "array",
                    "items": {
                        "type": "integer"
                    }
                },
                "created_at": {
                    "description": "CreatedAt is the capture timestamp (if known).",
                    "type": "string"
                },
                "headers": {
                    "description": "Headers contains optional header data (headers, content-type, etc).",
                    "type": "object",
                    "additionalProperties": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                "id": {
                    "description": "ID is an opaque identifier (e.g., uuid or incremental string) assigned by the tracker.",
                    "type": "string"
                },
                "status_code": {
                    "description": "Status Code indicates the result of the snapshot attempt (e.g., 200, 404, error codes).",
                    "type": "integer"
                },
                "url": {
                    "description": "URL is the source URL for the snapshot when available.",
                    "type": "string"
                },
                "version_id": {
                    "description": "VersionID is the version this snapshot belongs to.",
                    "type": "string"
                }
            }
        },
        "registry.Project": {
            "type": "object",
            "properties": {
                "created_at": {
                    "type": "integer"
                },
                "description": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "meta": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "slug": {
                    "type": "string"
                }
            }
        },
        "registry.Website": {
            "type": "object",
            "properties": {
                "config": {
                    "type": "string"
                },
                "created_at": {
                    "type": "integer"
                },
                "id": {
                    "type": "string"
                },
                "last_seen_at": {
                    "type": "integer"
                },
                "origin": {
                    "type": "string"
                },
                "project_id": {
                    "type": "string"
                },
                "slug": {
                    "type": "string"
                },
                "storage_path": {
                    "type": "string"
                }
            }
        },
        "server.AddWebsiteEndpointsRequest": {
            "type": "object",
            "properties": {
                "source": {
                    "type": "string",
                    "example": "manual"
                },
                "urls": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "example": [
                        "[\"http://localhost:9999/index\"]"
                    ]
                }
            }
        },
        "server.AddedEndpointsResponse": {
            "type": "object",
            "properties": {
                "added": {
                    "type": "integer",
                    "example": 42
                }
            }
        },
        "server.CreateProjectRequest": {
            "type": "object",
            "properties": {
                "description": {
                    "type": "string",
                    "example": "Project for IBM's public website"
                },
                "name": {
                    "type": "string",
                    "example": "IBM"
                },
                "slug": {
                    "type": "string",
                    "example": "ibm"
                }
            }
        },
        "server.CreateWebsiteRequest": {
            "type": "object",
            "properties": {
                "origin": {
                    "type": "string",
                    "example": "http://localhost:9999"
                },
                "slug": {
                    "type": "string",
                    "example": "demo"
                }
            }
        },
        "server.ErrorResponse": {
            "type": "object",
            "properties": {
                "error": {
                    "type": "string",
                    "example": "not found"
                }
            }
        },
        "server.StartFetchJobRequest": {
            "type": "object",
            "properties": {
                "limit": {
                    "type": "integer",
                    "example": 100
                },
                "status": {
                    "type": "string",
                    "example": "*"
                }
            }
        }
    }
}